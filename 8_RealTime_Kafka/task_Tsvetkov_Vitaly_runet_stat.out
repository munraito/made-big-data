-------------------------------------------
Batch: 0
-------------------------------------------
+------+----+----+------+
|window|zone|view|unique|
+------+----+----+------+
+------+----+----+------+

-------------------------------------------
Batch: 1
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |28  |29    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|11  |11    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |35  |35    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|15  |15    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |7   |7     |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|4   |4     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 2
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |55  |52    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|29  |30    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |67  |64    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|33  |34    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |12  |12    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|4   |4     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 3
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |78  |75    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|37  |37    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |104 |103   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|46  |46    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |26  |27    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|9   |8     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 4
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |83  |81    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|39  |38    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |120 |120   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|54  |54    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |37  |37    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|15  |14    |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 5
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |85  |83    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|40  |39    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |141 |137   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|59  |58    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |56  |55    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|19  |18    |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 6
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |93  |89    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|42  |42    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |178 |168   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|72  |72    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |85  |82    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|30  |29    |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 7
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |199 |189   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|76  |76    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |98  |97    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|31  |30    |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 8
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |218 |205   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|82  |83    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |117 |118   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|37  |36    |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 9
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |239 |230   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|89  |91    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |138 |142   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|44  |43    |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 10
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |250 |244   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|93  |93    |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |155 |161   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|49  |48    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |6   |6     |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|1   |1     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 11
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |264 |262   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|102 |101   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |171 |179   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|58  |58    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |8   |8     |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|1   |1     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 12
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |277 |272   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|104 |104   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |194 |201   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|60  |60    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |18  |18    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|1   |1     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 13
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |298 |291   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|107 |108   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |218 |223   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|63  |64    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |21  |20    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|1   |1     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 14
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |315 |305   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|113 |115   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |235 |241   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|69  |71    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |21  |20    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|1   |1     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 15
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |348 |345   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|120 |121   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |273 |281   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|81  |81    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |26  |26    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|6   |6     |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 16
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |356 |355   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|122 |123   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |295 |298   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|87  |88    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |40  |39    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|10  |10    |
+------------------------------------------+------+----+------+

-------------------------------------------
Batch: 17
-------------------------------------------
+------------------------------------------+------+----+------+
|window                                    |zone  |view|unique|
+------------------------------------------+------+----+------+
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|ru    |101 |95    |
|[2018-04-01 15:20:45, 2018-04-01 15:20:47]|not ru|45  |45    |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|ru    |371 |361   |
|[2018-04-01 15:20:46, 2018-04-01 15:20:48]|not ru|129 |129   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|ru    |310 |307   |
|[2018-04-01 15:20:47, 2018-04-01 15:20:49]|not ru|94  |94    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|ru    |40  |39    |
|[2018-04-01 15:20:48, 2018-04-01 15:20:50]|not ru|10  |10    |
+------------------------------------------+------+----+------+

Traceback (most recent call last):
  File "/home/group_mail_2021q1/made21q1_cvetkov/hw8/fin_hw8/task_Tsvetkov_Vitaly_runet_stat.py", line 65, in <module>
    query.awaitTermination()
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/sql/streaming.py", line 103, in awaitTermination
  File "/usr/local/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1255, in __call__
  File "/usr/local/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 985, in send_command
  File "/usr/local/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1152, in send_command
  File "/usr/lib/python3.6/socket.py", line 586, in readinto
    return self._sock.recv_into(b)
  File "/usr/local/spark/python/lib/pyspark.zip/pyspark/context.py", line 270, in signal_handler
KeyboardInterrupt
